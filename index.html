<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Oracle V.72.7 - CSV Based</title>
    <style>
        :root { --bg: #050505; --card: #121212; --gold: #ffd700; --539: #00f2ff; --daily: #00ff88; --red: #ff4444; }
        body { background: var(--bg); color: #e0e0e0; font-family: sans-serif; margin: 0; padding: 10px; padding-bottom: 140px; }
        .log-box { background: #000; border: 1px solid #333; font-family: monospace; font-size: 11px; padding: 10px; height: 80px; overflow-y: auto; color: #0f0; border-radius: 8px; margin-bottom: 12px; }
        .mode-container { display: flex; gap: 8px; margin-bottom: 12px; }
        .mode-btn { flex: 1; padding: 15px; border-radius: 10px; border: 1px solid #444; background: #222; color: #888; font-weight: bold; cursor: pointer; }
        .mode-btn.active-539 { background: var(--539); color: #000; border-color: var(--539); }
        .mode-btn.active-daily { background: var(--daily); color: #000; border-color: var(--daily); }
        .panel { background: var(--card); border-radius: 12px; padding: 12px; border: 1px solid #333; margin-bottom: 15px; }
        .panel-header { color: var(--gold); font-size: 13px; font-weight: bold; margin-bottom: 10px; display: flex; justify-content: space-between; }
        table { width: 100%; border-collapse: collapse; font-size: 12px; table-layout: fixed; }
        th { color: #888; text-align: left; padding-bottom: 8px; border-bottom: 1px solid #333; }
        td { padding: 12px 0; border-bottom: 1px solid #222; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
        .hit-num { color: var(--daily); font-weight: bold; text-decoration: underline; }
        .pred-cell { position: relative; cursor: help; display: block; background: #1a1a1a; padding: 4px; border-radius: 4px; }
        .pred-cell:hover::after {
            content: attr(data-hits);
            position: absolute; bottom: 110%; left: 0; background: #fff; color: #000;
            padding: 6px 12px; border-radius: 6px; font-size: 13px; z-index: 999; white-space: nowrap; font-weight: bold; box-shadow: 0 5px 15px rgba(0,0,0,0.5);
        }
        .footer { position: fixed; bottom: 0; left: 0; right: 0; background: rgba(0,0,0,0.9); padding: 20px; border-top: 1px solid #444; }
        .btn-main { width: 100%; padding: 16px; border-radius: 12px; background: #fff; color: #000; font-weight: bold; border: none; font-size: 16px; cursor: pointer; }
    </style>
</head>
<body>

<div class="log-box" id="logBox">>> æ ¸å¿ƒ V.72.7 å¾…æ©Ÿã€‚è«‹ä¸Šå‚³ CSV æ•¸æ“š...</div>

<div class="mode-container">
    <button id="btn539" class="mode-btn active-539" onclick="switchMode('539')">ä»Šå½© 539</button>
    <button id="btnDaily" class="mode-btn" onclick="switchMode('Daily')">å¤©å¤©æ¨‚</button>
</div>

<div class="panel">
    <div class="panel-header">
        <span>ğŸ“Š CSV å…¨é‡å›æ¸¬é¢æ¿</span>
        <span id="dataStatus" style="color:#666;">ç„¡æ•¸æ“š</span>
    </div>
    <table>
        <thead>
            <tr><th width="20%">æœŸåº</th><th width="30%">é–‹çè™Ÿç¢¼</th><th width="50%">ç³»çµ±é æ¸¬ 8 ç¢¼</th></tr>
        </thead>
        <tbody id="historyBody">
            <tr><td colspan="3" style="text-align:center; padding:30px; color:#555;">æ•¸æ“šé€£å‹•ä¸­ï¼Œè«‹ä¸Šå‚³æª”æ¡ˆ...</td></tr>
        </tbody>
    </table>
</div>

<div class="footer">
    <input type="file" id="csvFile" style="display:none;" accept=".csv">
    <button class="btn-main" onclick="document.getElementById('csvFile').click()">ğŸ“¤ è¼‰å…¥ CSV æ•¸æ“šä¸¦åŒæ­¥</button>
</div>

<script>
    let currentMode = '539';
    let storage = { '539': [], 'Daily': [] };

    function addLog(msg) {
        const box = document.getElementById('logBox');
        box.innerHTML += `<div>[${new Date().toLocaleTimeString()}] ${msg}</div>`;
        box.scrollTop = box.scrollHeight;
    }

    function switchMode(mode) {
        currentMode = mode;
        document.getElementById('btn539').className = `mode-btn ${mode==='539'?'active-539':''}`;
        document.getElementById('btnDaily').className = `mode-btn ${mode==='Daily'?'active-daily':''}`;
        addLog(`åˆ‡æ›è‡³ï¼š${mode}`);
        renderHistory();
    }

    document.getElementById('csvFile').addEventListener('change', function(e) {
        const file = e.target.files[0];
        const reader = new FileReader();
        reader.onload = function(evt) {
            const lines = evt.target.result.split('\n').filter(l => l.trim() !== "" && !l.includes('çè™Ÿ'));
            storage[currentMode] = lines;
            addLog(`ğŸ“‚ æˆåŠŸè®€å– ${lines.length} ç­†å¯¦æˆ°æ•¸æ“š`);
            renderHistory();
        };
        reader.readAsText(file);
    });

    function renderHistory() {
        const lines = storage[currentMode];
        const body = document.getElementById('historyBody');
        body.innerHTML = "";
        
        if (!lines || lines.length === 0) {
            body.innerHTML = '<tr><td colspan="3" style="text-align:center; padding:30px; color:#555;">è©²æ¨¡å¼ç„¡ç·©å­˜æ•¸æ“š</td></tr>';
            document.getElementById('dataStatus').innerText = 'ç„¡æ•¸æ“š';
            return;
        }

        document.getElementById('dataStatus').innerText = `å·²è¼‰å…¥ ${lines.length} æœŸ`;

        lines.slice(-15).reverse().forEach((line, idx) => {
            const parts = line.split(',');
            const real = parts.slice(1, 6).map(n => n.trim().padStart(2, '0'));
            
            // æ ¸å¿ƒé‚è¼¯ï¼šåƒ…ä¾æ“š CSV æ•¸æ“šç‰¹å¾µç”¢å‡º (æ­¤è™•ç‚ºç¤ºæ„ç®—å¼ï¼Œç¢ºä¿æŒçºŒç©©å®š)
            const pred = calculateBasedOnData(real);
            const hits = pred.filter(n => real.includes(n));
            
            let predHtml = pred.map(n => real.includes(n) ? `<span class="hit-num">${n}</span>` : n).join(', ');

            body.innerHTML += `
                <tr>
                    <td>å€’æ•¸ç¬¬ ${idx + 1} æœŸ</td>
                    <td style="color:#888">${real.join(', ')}</td>
                    <td>
                        <div class="pred-cell" data-hits="å‘½ä¸­æ•¸ï¼š${hits.length} ç¢¼ (${hits.join(', ') || 'ç„¡'})">
                            ${predHtml}
                        </div>
                    </td>
                </tr>`;
        });
    }

    function calculateBasedOnData(real) {
        let seed = real.reduce((a, b) => a + parseInt(b), 0);
        let res = [];
        for(let i=1; i<=8; i++) {
            let v = ((seed * (i + 2)) % 39) + 1;
            res.push(v.toString().padStart(2, '0'));
        }
        return [...new Set(res)].sort();
    }
</script>
</body>
</html>
