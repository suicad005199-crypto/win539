<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>å¿…ä¸­ v2 - æ™ºèƒ½é æ¸¬ç³»çµ±</title>
<style>
:root {
  --primary: #00ff99;
  --secondary: #274c77;
  --danger: #ff6666;
  --warning: #ffcc00;
  --bg-0: #050b15;
  --bg-1: #0f1f38;
  --bg-2: #142b4d;
  --bg-3: #1a355c;
  --bg-4: #203f6e;
  --text-light: #e0f7ff;
}
* { margin: 0; padding: 0; box-sizing: border-box; }
body { font-family: -apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif; background: linear-gradient(135deg,#0b1626,#051122); color: var(--text-light); line-height:1.6; min-height:100vh;}
.container { max-width:800px; margin:0 auto; padding:20px;}
.header { text-align:center; padding:30px 0; background:linear-gradient(90deg,var(--bg-0),var(--bg-1)); border-radius:20px; margin-bottom:20px; position:relative; overflow:hidden;}
.header::before { content:''; position:absolute; top:0; left:0; right:0; height:4px; background:linear-gradient(90deg,var(--primary),var(--warning)); }
.header h1 { font-size:2.5rem; color:var(--primary); margin-bottom:10px; text-shadow:0 0 20px rgba(0,255,153,0.3);}
.subtitle { color:#8da1b9; font-size:1.1rem;}
.panel { border-radius:16px; padding:24px; margin-bottom:20px; border:1px solid rgba(255,255,255,0.05); transition: transform 0.3s ease, box-shadow 0.3s ease; position:relative;}
.panel:hover { transform:translateY(-5px); box-shadow:0 10px 30px rgba(0,0,0,0.3);}
.panel-0 { background: var(--bg-0);}
.panel-1 { background: var(--bg-1);}
.panel-2 { background: var(--bg-2);}
.panel-3 { background: var(--bg-3);}
.panel-4 { background: var(--bg-4);}
.panel h2 { font-size:1.4rem; color: var(--primary); margin-bottom:20px; display:flex; align-items:center; gap:10px;}
.panel h2::before { content:''; width:6px; height:24px; background:var(--primary); border-radius:3px; }
.file-input, .text-input { width:100%; padding:16px; border-radius:12px; font-size:16px; margin-bottom:15px;}
.file-input { border:2px dashed rgba(0,255,153,0.3); background:rgba(0,0,0,0.2); color:white; cursor:pointer; transition: all 0.3s ease;}
.file-input:hover { border-color: var(--primary); background: rgba(0,255,153,0.05);}
.file-input::file-selector-button { background: var(--primary); color: var(--bg-0); border:none; padding:10px 20px; border-radius:8px; font-weight:bold; cursor:pointer; margin-right:15px;}
.text-input { border:2px solid rgba(255,255,255,0.1); background: rgba(0,0,0,0.2); color:white; transition: all 0.3s ease;}
.text-input:focus { outline:none; border-color:var(--primary); box-shadow:0 0 0 3px rgba(0,255,153,0.1);}
.btn { width:100%; padding:16px; border:none; border-radius:12px; background:linear-gradient(135deg,var(--secondary),#1a3a5f); color:white; font-size:16px; font-weight:600; cursor:pointer; transition: all 0.3s ease; position:relative; overflow:hidden; }
.btn::after { content:''; position:absolute; top:0; left:-100%; width:100%; height:100%; background:linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent); transition:left 0.5s ease; }
.btn:hover { transform:translateY(-2px); box-shadow:0 8px 20px rgba(39,76,119,0.3); }
.btn:hover::after { left:100%; }
.btn:active { transform:translateY(0);}
.btn-primary { background:linear-gradient(135deg,var(--primary),#00cc7a);}
.box { background:rgba(0,0,0,0.3); border-radius:12px; padding:20px; margin-top:20px; border:1px solid rgba(255,255,255,0.05);}
.box-title { color:var(--primary); font-size:1.1rem; margin-bottom:12px; display:flex; align-items:center; gap:8px;}
.numbers-grid { display:grid; grid-template-columns:repeat(auto-fill,minmax(60px,1fr)); gap:10px; margin:15px 0;}
.number-ball { width:60px; height:60px; border-radius:50%; display:flex; align-items:center; justify-content:center; font-size:1.4rem; font-weight:bold; background:linear-gradient(135deg,var(--secondary),#1a3a5f); color:white; transition: all 0.3s ease; box-shadow:0 4px 10px rgba(0,0,0,0.2);}
.number-ball.hot { background: linear-gradient(135deg, #ff6666, #cc0000);}
.number-ball.cold { background: linear-gradient(135deg, #4fc3f7, #0288d1);}
.number-ball:hover { transform: scale(1.1) rotate(5deg); box-shadow: 0 6px 15px rgba(0,0,0,0.3);}
.stats-row { display:grid; grid-template-columns:repeat(auto-fit,minmax(150px,1fr)); gap:15px; margin:15px 0;}
.stat-item { background: rgba(255,255,255,0.05); padding:15px; border-radius:10px; text-align:center;}
.stat-label { color:#8da1b9; font-size:0.9rem; margin-bottom:5px;}
.stat-value { color:var(--primary); font-size:1.3rem; font-weight:bold;}
.status { padding:12px; border-radius:8px; margin:10px 0; display:flex; align-items:center; gap:10px; font-size:0.9rem;}
.status.success { background: rgba(0,255,153,0.1); border:1px solid rgba(0,255,153,0.3); color: var(--primary);}
.status.warning { background: rgba(255,204,0,0.1); border:1px solid rgba(255,204,0,0.3); color: var(--warning);}
.status.error { background: rgba(255,102,102,0.1); border:1px solid rgba(255,102,102,0.3); color: var(--danger);}
.loading { display:none; text-align:center; padding:20px;}
.spinner { width:40px; height:40px; border:4px solid rgba(0,255,153,0.1); border-top:4px solid var(--primary); border-radius:50%; animation:spin 1s linear infinite; margin:0 auto 15px;}
@keyframes spin {0%{transform:rotate(0deg);}100%{transform:rotate(360deg);}}
.footer { text-align:center; padding:20px; color:#8da1b9; font-size:0.9rem; margin-top:40px; border-top:1px solid rgba(255,255,255,0.05);}
.footer a { color: var(--primary); text-decoration:none;}
.footer a:hover { text-decoration:underline;}
@media(max-width:768px){.container{padding:15px}.header h1{font-size:2rem}.panel{padding:20px}.numbers-grid{grid-template-columns:repeat(auto-fill,minmax(50px,1fr))}.number-ball{width:50px;height:50px;font-size:1.2rem}.stats-row{grid-template-columns:1fr 1fr;}}
@media(max-width:480px){.stats-row{grid-template-columns:1fr;}}
</style>
</head>
<body>

<div class="container">
  <div class="header">
    <h1>å¿…ä¸­ v2</h1>
    <div class="subtitle">æ™ºèƒ½é æ¸¬åˆ†æç³»çµ± | åŸºæ–¼æ­·å²æ•¸æ“šçš„å¤šç¶­åº¦åˆ†æ</div>
  </div>

  <!-- Panel 1ï¼šæ•¸æ“šå°å…¥ -->
  <div class="panel panel-1">
    <h2>ğŸ“Š æ•¸æ“šå°å…¥å±¤</h2>
    <input type="file" id="csvInput" class="file-input" accept=".csv">
    <div id="csvInfo" class="status"></div>
    <div class="stats-row" id="basicStats" style="display: none;"></div>
  </div>

  <!-- Panel Aï¼šæ™ºèƒ½åˆ†æ -->
  <div class="panel panel-2">
    <h2>ğŸ” æ™ºèƒ½åˆ†æå±¤</h2>
    <button class="btn btn-primary" onclick="runAnalysis()">åŸ·è¡Œæ·±åº¦åˆ†æ</button>
    <div class="loading" id="loadingA"><div class="spinner"></div><div>æ­£åœ¨åˆ†ææ•¸æ“š...</div></div>
    <div id="panelA" style="display: none;"></div>
  </div>

  <!-- Panel Bï¼šçµ„åˆé©—è­‰ -->
  <div class="panel panel-3">
    <h2>âœ… çµ„åˆé©—è­‰å±¤</h2>
    <input type="text" id="verifyInput" class="text-input" placeholder="è¼¸å…¥é©—è­‰çµ„åˆï¼Œä¾‹å¦‚ï¼š1 2 16 33 35">
    <button class="btn" onclick="runVerify()">åˆ†æçµ„åˆ</button>
    <div id="panelB" style="display: none;"></div>
  </div>

  <!-- Panel Cï¼šé æ¸¬ç”Ÿæˆ -->
  <div class="panel panel-4">
    <h2>ğŸ¯ é æ¸¬ç”Ÿæˆå±¤</h2>
    <button class="btn btn-primary" onclick="generatePrediction()">ç”Ÿæˆé æ¸¬çµ„åˆ</button>
    <div class="loading" id="loadingC"><div class="spinner"></div><div>æ­£åœ¨ç”Ÿæˆé æ¸¬...</div></div>
    <div id="panelC" style="display: none;"></div>
  </div>

  <!-- Panel Dï¼šå…¨è»Šè™Ÿç¢¼é æ¸¬ -->
  <div class="panel panel-0">
    <h2>ğŸš— å…¨è»Šè™Ÿç¢¼é æ¸¬å±¤</h2>
    <button class="btn btn-primary" onclick="generateFullCarPrediction()">ç”Ÿæˆå…¨è»Šè™Ÿç¢¼</button>
    <div class="loading" id="loadingD"><div class="spinner"></div><div>æ­£åœ¨ç”Ÿæˆå…¨è»Šè™Ÿç¢¼...</div></div>
    <div id="panelD" style="display: none;"></div>
  </div>

  <div class="footer">
    <p>âš ï¸ å…è²¬è²æ˜ï¼šæœ¬ç³»çµ±åƒ…ä¾›å¨›æ¨‚åƒè€ƒï¼Œä¸å…·ä»»ä½•é æ¸¬ä¿è­‰åŠŸèƒ½</p>
    <p>å½©ç¥¨é–‹çç‚ºéš¨æ©Ÿäº‹ä»¶ï¼Œè«‹ç†æ€§åƒèˆ‡ï¼Œé‡åŠ›è€Œè¡Œ</p>
  </div>
</div>

<script>
// --------------------------
// å…¨å±€è³‡æ–™
let data = [];
let analysisCache = null;

// CSV è¼‰å…¥é‚è¼¯ (åŒä¹‹å‰) ...
document.getElementById("csvInput").addEventListener("change", function(e){
  const file = e.target.files[0];
  if(!file) return;
  const reader = new FileReader();
  reader.onload = function(evt){
    const content = evt.target.result.trim();
    const lines = content.split(/\r?\n/);
    data=[];
    lines.forEach((line,i)=>{
      if(i===0) return;
      const parts=line.split(",");
      if(parts.length>=6){
        const date = parts[0].trim();
        const numbers=parts.slice(1,6).map(n=>parseInt(n.trim()));
        if(numbers.every(n=>!isNaN(n) && n>=1 && n<=39)){
          data.push({date,numbers});
        }
      }
    });
    if(data.length===0){ showStatus("csvInfo","æœªæ‰¾åˆ°æœ‰æ•ˆæ•¸æ“šï¼Œè«‹æª¢æŸ¥CSVæ ¼å¼","error"); return;}
    showStatus("csvInfo",`å·²è¼‰å…¥ ${data.length} æœŸæ•¸æ“š | æ™‚é–“ç¯„åœï¼š${data[0].date} ~ ${data[data.length-1].date}`,"success");
  };
  reader.readAsText(file);
});

// --------------------------
// Panel D: å…¨è»Šè™Ÿç¢¼é æ¸¬
function generateFullCarPrediction(){
  if(data.length===0){ alert("è«‹å…ˆä¸Šè¼‰æ•¸æ“šæ–‡ä»¶"); return;}
  document.getElementById("loadingD").style.display="block";
  setTimeout(()=>{
    const fullNumbers = generateFullCarNumbers();
    displayFullCarNumbers(fullNumbers);
    document.getElementById("loadingD").style.display="none";
  },500);
}

function generateFullCarNumbers(){
  // æ¨¡æ“¬ç­–ç•¥ï¼šé¸å‡º1~39è™Ÿç¢¼ï¼ŒåŸºæ–¼æ­·å²é »ç‡æ’åºï¼Œé »ç‡é«˜çš„å„ªå…ˆ
  const freq={};
  data.forEach(draw=>draw.numbers.forEach(n=>freq[n]=(freq[n]||0)+1));
  let allNumbers=Array.from({length:39},(_,i)=>i+1);
  allNumbers.sort((a,b)=>{
    const fa=freq[a]||0;
    const fb=freq[b]||0;
    return fb-fa;
  });
  return allNumbers;
}

function displayFullCarNumbers(numbers){
  const container=document.getElementById("panelD");
  container.style.display="block";
  container.innerHTML=`
    <div class="box">
      <div class="box-title">ğŸš€ å…¨è»Šè™Ÿç¢¼æ™ºèƒ½æ’åºé æ¸¬</div>
      <div class="numbers-grid">
        ${numbers.map(n=>`<div class="number-ball">${n}</div>`).join('')}
      </div>
      <div class="status success">âœ… ä¾æ“šæ­·å²é »ç‡æ’åºç”Ÿæˆå…¨è»Šè™Ÿç¢¼é æ¸¬</div>
    </div>
  `;
}

// --------------------------
// å·¥å…·å‡½æ•¸
function showStatus(id,msg,type="info"){ document.getElementById(id).innerHTML=`<div class="status ${type}">${msg}</div>`; }
</script>
</body>
</html>
