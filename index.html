<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>CSV 邏輯驗證面板</title>
    <style>
        :root { --ios-blue: #007AFF; --ios-bg: #F2F2F7; }
        body { font-family: -apple-system, sans-serif; background: var(--ios-bg); margin: 0; padding: 20px 15px; color: #1C1C1E; }
        .upload-section { background: white; border-radius: 12px; padding: 20px; text-align: center; margin-bottom: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.05); }
        input[type="file"] { margin-top: 10px; font-size: 14px; width: 100%; }
        .card { background: white; border-radius: 12px; padding: 16px; margin-bottom: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.05); }
        .num-header { display: flex; align-items: center; justify-content: space-between; margin-bottom: 10px; }
        .num-circle { background: var(--ios-blue); color: white; width: 35px; height: 35px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; }
        .method-box { background: #F8F8FA; border-left: 3px solid var(--ios-blue); padding: 10px; border-radius: 4px; font-size: 14px; }
        .found { color: #34C759; font-weight: bold; }
        .not-found { color: #FF3B30; font-weight: bold; }
    </style>
</head>
<body>

    <div class="upload-section">
        <h3>上傳數據進行驗證</h3>
        <input type="file" id="csvFile" accept=".csv">
    </div>

    <div id="results">
        </div>

    <script>
        const targets = [1, 33, 16, 35, 2];
        const fileInput = document.getElementById('csvFile');
        const resultsDiv = document.getElementById('results');

        fileInput.addEventListener('change', function(e) {
            const file = e.target.files[0];
            const reader = new FileReader();

            reader.onload = function(event) {
                const text = event.target.result;
                processData(text);
            };
            reader.readAsText(file);
        });

        function processData(csvText) {
            const rows = csvText.split('\n').map(row => row.split(','));
            resultsDiv.innerHTML = '<h2>驗證結果</h2>';

            targets.forEach(target => {
                let foundLocation = null;
                
                // 遍歷搜尋邏輯
                for (let r = 0; r < rows.length; r++) {
                    for (let c = 0; c < rows[r].length; c++) {
                        if (parseFloat(rows[r][c]) === target) {
                            foundLocation = { row: r + 1, col: c + 1 };
                            break;
                        }
                    }
                    if (foundLocation) break;
                }

                renderCard(target, foundLocation);
            });
        }

        function renderCard(target, loc) {
            const statusClass = loc ? 'found' : 'not-found';
            const statusText = loc ? '已驗證成功' : '未在檔案中找到';
            const methodContent = loc 
                ? `於 CSV 第 <span style="text-decoration:underline">${loc.row}</span> 列，第 <span style="text-decoration:underline">${loc.col}</span> 欄匹配成功。` 
                : '請檢查原始檔案是否包含此數值。';

            resultsDiv.innerHTML += `
                <div class="card">
                    <div class="num-header">
                        <div class="num-circle">${target}</div>
                        <span class="${statusClass}">${statusText}</span>
                    </div>
                    <div class="method-box">
                        <strong>取得方式：</strong><br>
                        ${methodContent}
                    </div>
                </div>
            `;
        }
    </script>
</body>
</html>
