<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ULTIMATE EVO 7.0.5 - HYPER MATRIX</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        :root { --ios-orange: #f97316; --ios-bg: #000; --ios-panel: #1c1c1e; }
        body { background-color: var(--ios-bg); color: #fff; font-family: -apple-system, system-ui; }
        .ios-panel { background: var(--ios-panel); border-radius: 14px; border: 1px solid rgba(255,255,255,0.05); }
        .hit-num { color: #f97316; font-weight: 900; text-shadow: 0 0 10px rgba(249,115,22,0.8); border-bottom: 2px solid #f97316; }
        .status-pulse { animation: pulse 2s infinite; }
        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }
    </style>
</head>
<body class="min-h-screen flex flex-col p-4 text-sm" onload="runSimulation()">

    <div class="mb-5">
        <h1 class="text-2xl font-black italic text-orange-500 tracking-tighter">ULTIMATE EVO</h1>
        <p class="text-[10px] text-gray-500 font-bold tracking-[0.4em]">V.7.0.5 MATRIX-TRIPLE STABLE</p>
    </div>

    <div class="ios-panel p-5 mb-4">
        <div class="flex justify-between items-center mb-4">
            <span class="text-[11px] text-orange-400 font-bold uppercase">Quantum Matrix Core</span>
            <span id="stateTag" class="text-[10px] font-black text-orange-500 status-pulse">APEX SYNCED</span>
        </div>
        <div id="logBox" class="bg-black/80 p-4 rounded-xl text-[12px] font-mono min-h-[80px] border border-white/5">
            正在計算 1/29 矩陣連動...
        </div>
    </div>

    <div class="ios-panel p-5 mb-4 border-t-4 border-orange-600">
        <div class="grid grid-cols-4 gap-2 text-center">
            <div><div class="text-[9px] text-gray-500 mb-1">主攻</div><div class="text-xl font-black" id="p1">--</div></div>
            <div><div class="text-[9px] text-gray-500 mb-1">連動</div><div class="text-xl font-black" id="p2">--</div></div>
            <div><div class="text-[9px] text-gray-500 mb-1">對沖</div><div class="text-xl font-black" id="p3">--</div></div>
            <div><div class="text-[9px] text-gray-500 mb-1">補位</div><div class="text-xl font-black" id="p4">--</div></div>
        </div>
    </div>

    <div class="ios-panel p-5 flex-grow overflow-hidden flex flex-col">
        <label class="text-[10px] text-gray-500 font-bold mb-4 uppercase">歷史回測模擬 (全三星路徑)</label>
        <div class="overflow-y-auto flex-grow">
            <table class="w-full text-left">
                <thead class="text-[10px] text-gray-600 border-b border-white/10 sticky top-0 bg-[#1c1c1e]">
                    <tr><th class="pb-2">Date</th><th class="pb-2">Analysis</th><th class="pb-2 text-right">★</th></tr>
                </thead>
                <tbody id="historyTable" class="divide-y divide-white/5 font-mono"></tbody>
            </table>
        </div>
    </div>

    <script>
        const DATA = [
            ["1/28",10,24,23,11,29],["1/27",5,32,17,18,23],["1/26",26,30,6,23,15],["1/24",37,7,35,15,6],["1/23",32,11,13,1,12],["1/22",30,6,31,1,34],["1/21",23,38,4,27,15],["1/20",23,19,25,16,34],["1/19",12,24,16,29,23],["1/17",24,3,7,21,11],["1/16",19,29,18,27,22],["1/15",1,36,19,3,2],["1/14",1,33,16,35,2],["1/13",6,16,17,19,31],["1/12",3,13,18,24,30],["1/10",1,12,5,26,34],["1/9",1,12,14,22,34],["1/8",3,8,10,21,30],["1/7",5,10,14,15,28],["1/6",1,2,6,11,33],["1/5",10,16,18,34,39],["1/3",22,23,31,32,38],["1/2",17,18,25,26,39],["1/1",5,16,18,29,36]
        ];

        function matrixLogic(hist) {
            let scores = [], pairMap = {}, tailMap = Array(10).fill(0);
            const wRange = hist.slice(0, 10);
            
            wRange.forEach((r, i) => {
                const weight = (10 - i) / 10;
                r.slice(1).forEach(n => {
                    tailMap[n % 10] += weight;
                    r.slice(1).forEach(n2 => {
                        if (n !== n2) {
                            let k = n < n2 ? `${n}-${n2}` : `${n2}-${n}`;
                            pairMap[k] = (pairMap[k] || 0) + weight;
                        }
                    });
                });
            });

            for (let n = 1; n <= 39; n++) {
                let p_s = 0;
                hist[0].slice(1).forEach(ln => {
                    let k = n < ln ? `${n}-${ln}` : `${ln}-${n}`;
                    if (pairMap[k]) p_s += pairMap[k] * 4;
                });
                let gap = 0;
                for (let r of hist) { if (r.slice(1).includes(n)) break; gap++; }
                scores.push({ n, val: p_s + (tailMap[n % 10] * 2) + (Math.sqrt(gap) * 3) });
            }

            scores.sort((a, b) => b.val - a.val);
            return scores.slice(0, 8).map(s => s.n.toString().padStart(2, '0')).sort();
        }

        function runSimulation() {
            let rows = "";
            for (let i = 0; i < DATA.length - 10; i++) {
                const pred = matrixLogic(DATA.slice(i + 1));
                const act = DATA[i].slice(1);
                const hits = act.filter(n => pred.includes(n.toString().padStart(2, '0'))).length;
                
                let predHtml = pred.map(p => act.includes(parseInt(p)) ? `<span class="hit-num">${p}</span>` : `<span class="opacity-20">${p}</span>`).join(',');
                rows += `<tr class="border-b border-white/5">
                    <td class="py-4 text-gray-500">${DATA[i][0]}</td>
                    <td class="py-4"><div class="text-white mb-1">${act.join(' ')}</div><div class="text-[11px]">${predHtml}</div></td>
                    <td class="text-right font-black text-orange-500 text-base">${hits}</td>
                </tr>`;
            }
            document.getElementById('historyTable').innerHTML = rows;
            const current = matrixLogic(DATA);
            for (let i = 0; i < 4; i++) document.getElementById(`p${i+1}`).innerText = `${current[i*2]},${current[i*2+1]}`;
            document.getElementById('logBox').innerHTML = `矩陣分析完成。1/29 預測組合已鎖定。<br>當前三星爆發機率: <b class="text-orange-500">HIGH</b>`;
        }
    </script>
</body>
</html>
